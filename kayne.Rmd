---
title: "Final Assignment"
author: " Pablo Romero, Irene García, Jorge Ramos"
date: "2025-04-04"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

# Introduction

Kanye West, known for his unique style and ability to fuse musical
genres, has sparked numerous debates both for his music and his behavior
offstage. Recently, he has been at the center of media attention due to
controversial remarks and attitudes, including neo-Nazi comments and his
contentious treatment of his partners (such as his ex-wife, Kim
Kardashian, or his current wife, Bianca Censori). These situations have
raised growing concerns about the potential impact of his persona on
society.

Text analysis is a fundamental tool for this purpose, allowing us to
extract patterns and insights from large volumes of textual data. To
achieve this, three different techniques have been selected:

1.  Sentiment Analysis: The objective is to explore the emotions and
    sentiments expressed in his songs throughout his career.

2.  Term Frequency - TF-IDF: The objective is to detect rare words in albums compared to others and see how representative offensive words are.

3.  


```{r setup, include = FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,  
  echo = TRUE
  )
```

# Packages
```{r libraries}
library(readr)
library(tidyverse)
library(geniusr)
library(tidytext)
library(devtools)
library(forcats)
library(wordcloud)
library(RColorBrewer)
```

For reproducibility:
```{r}
set.seed(123)
```

# Download the data

The selected dataframe comes from a GitHub repository containing a total
of 98 Kanye West songs, covering his discography from 2004 to 2018.
However, the original CSV file does not include album identification or
release years, so this information will need to be added manually to
complete the analysis.

```{r}
# Read the data from GitHub
Kanye_West <- read.csv("https://github.com/babyakja/GA_capstone_project/raw/master/data/Kanye%25West.csv")

# Create a vector including the songs for each album
album_data <- list(
  "The College Dropout (2004)" = c("We Don't Care", "Graduation Day", "All Falls Down", "Spaceship", "Jesus Walks", "Never Let Me Down", 
                                   "Get Em High", "Workout Plan", "The New Workout Plan", "Slow Jamz", "Breathe In Breathe Out",
                                   "School Spirit", "Lil Jimmy Skit", "Two Words", "Through the Wire", "Family Business", "Last Call", "I'll Fly Away"),
  
  "Late Registration (2005)" = c("Wake Up Mr. West", "Heard 'Em Say", "Touch the Sky", "Gold Digger", "Drive Slow", "My Way Home", 
                                 "Crack Music", "Roses", "Bring Me Down", "Addiction", "Diamonds From Sierra Leone (Remix)", 
                                 "We Major", "Hey Mama", "Celebration", "Gone", "Late"),
  
  "Graduation (2007)" = c("Good Morning", "Champion", "Stronger", "I Wonder", "Good Life", "Can't Tell Me Nothing", "Barry Bonds", 
                          "Drunk and Hot Girls", "Flashing Lights", "Everything I Am", "The Glory", "Homecoming", 
                          "Big Brother"),
  
  "808s & Heartbreak (2008)" = c("Say You Will", "Welcome To Heartbreak", "Heartless", "Amazing", "Love Lockdown", "Paranoid", 
                                 "RoboCop", "Street Lights", "Bad News", "See You in My Nightmares", "Coldest Winter"),
  
  "My Beautiful Dark Twisted Fantasy (2010)" = c("Dark Fantasy", "Gorgeous", "Power", "All Of The Lights (Interlude)", "All of the Lights", 
                                                "Monster", "So Appalled", "Devil in a New Dress", "Runaway", "Hell of a Life", 
                                                "Blame Game", "Lost in the World", "Who Will Survive In America"),
  
  "Yeezus (2013)" = c("On Sight", "Black Skinhead", "I Am a God", "New Slaves", "Blood On The Leaves", "Bound 2"),
  
  "The Life of Pablo (2016)" = c("Famous", "Feedback", "Low Lights", "Highlights", "Freestyle 4", "I Love Kanye", "Wolves", 
                                 "Facts (Charlie Heat Version)", "Fade", "Saint Pablo"),
  
  "Kids See Ghosts (2018)" = c("Kids See Ghosts", "Freeee (Ghost Town, Pt. 2)", "Fire", "4th Dimension", "Reborn", "Feel the Love", "Cudi Montage"),
  
  "Ye (2018)" = c("I Thought About Killing You", "Yikes", "All Mine", "Wouldn't Leave", "No Mistakes", "Ghost Town", "Violent Crimes"),
  
  "Singles" = c("Lift Yourself")
)

# Create the list with album and year of realease 
release_dates <- list(
  "The College Dropout (2004)" = "2004",
  "Late Registration (2005)" = "2005",
  "Graduation (2007)" = "2007",
  "808s & Heartbreak (2008)" = "2008",
  "My Beautiful Dark Twisted Fantasy (2010)" = "2010",
  "Yeezus (2013)" = "2013",
  "The Life of Pablo (2016)" = "2016",
  "Kids See Ghosts (2018)" = "2018",
  "Ye (2018)" = "2018",
  "Singles" = "2018"
)

# Create new columns and introduce the new info
Kanye_West$album <- sapply(Kanye_West$name, function(x) {
  album_found <- NA
  for (album in names(album_data)) {
    if (x %in% album_data[[album]]) {
      album_found <- album
      break
    }
  }
  return(album_found)
})

Kanye_West$release_date <- sapply(Kanye_West$album, function(x) release_dates[[x]])

#Finally, we convert the df into a tibble and verify the first columns
Kanye_West <- as_tibble(Kanye_West)
head(Kanye_West)



```

With this addition, we now have the necessary information to carry out
the analysis. As observed, there are a total of 9 albums and one song
that does not belong to any, meaning it is a single.

The next step is to filter the information, as the dataset contains some
peculiarities that could affect the analysis.

In the text variable, there is extra information that does not
correspond to the lyrics but instead includes details about the
production or specific parts of the song (e.g., Intro, Hook, etc.). If
this information were available for all songs, analyzing the producers
could provide valuable insights to enrich the study. However, since it
is not consistently present across all tracks, it is best to remove it
to avoid potential issues.

```{r}
# Remove the brackets and the information inside.
Kanye_West$text <- gsub("\\[.*?\\]", "", Kanye_West$text)
```

# Tokenization and stopwords:

The lyrics of Kanye West's songs will be tokenized to make working with
words more manageable and structured.

1.Punctuation will be removed since, in a text analysis like this, it
does not add value to identifying key words or term frequency.

2.All words will be converted to lowercase to prevent the same words in
uppercase and lowercase from being treated as different.

```{r}
# Tokenization with punctuation removal 
Kanye_West <- Kanye_West %>%
  unnest_tokens(word, text, drop = TRUE, strip_punct = TRUE, to_lower = TRUE) # drop = TRUE to remove the text column  

head(Kanye_West)
```

Now, we filter the stopwords (from `tidytext package`) in order to
eliminate those uninformative words:

```{r}
Kanye_West <- Kanye_West %>%
  anti_join(stop_words)
```

With these steps, we now have our table ready for analysis, ensuring
that the data is clean and structured.

# Introductory Analysis

Before delving into the selected techniques, it is necessary to conduct
an introductory analysis to better understand the distribution and
characteristics of the words present in Kanye West's lyrics.

```{r}
# Count the frequency of words
word_counts <- Kanye_West %>%
  count(word, sort = TRUE)

# top 10 most frequent words
head(word_counts, 10)
```

Words like "la," "yeah," and "shit" dominate the list, while others like
"love," "niggas," and "nigga" stand out due to their relevance in the
context of the artist's songs. Additionally, terms like "baby," "girl,"
and "life" suggest that Kanye also addresses personal relationships in
his lyrics.

The most common word, 'la', in this case refers to 'ya', which is a
slang term meaning 'you'. It is also important to note that Kanye West
frequently uses slang and colloquial expressions in his lyrics.

```{r}
# Visualization of words frequency
word_counts %>%
  filter(n > 50) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(x = word, y = n, fill = n)) + 
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() +  
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(title = "Most frequent words in Kanye West lyrics",
       x = NULL,
       y = "Frequency") +
  theme_minimal()
```

In this barplot, we can see the most commonly used words in more detail,
highlighting other words and expressions such as "y'all", "god", or
"fuck", among others.

```{r}
# Generar la nube de palabras
wordcloud(words = word_counts$word, 
          freq = word_counts$n, 
          min.freq = 5, 
          max.words = 200,  
          scale = c(4, 0.5),  
          colors = brewer.pal(8, "Dark2"), 
          random.order = FALSE)
```

En este wordcloud se puede ver también el uso de estas palabras, otras
que destacan son "girl" o "baby". Además, cabe mencionar también que
muchas de las palabras son referenciales, es decir que se dirigen a un
sujeto. Esto puede verse con el uso de expresiones como "y'all" (you
all) o "i'm".

The following chart shows the 10 most common words per album:

```{r}
# Album order for the plot
album_order <- c(
  "The College Dropout (2004)", 
  "Late Registration (2005)", 
  "Graduation (2007)", 
  "808s & Heartbreak (2008)", 
  "My Beautiful Dark Twisted Fantasy (2010)", 
  "Yeezus (2013)", 
  "The Life of Pablo (2016)", 
  "Kids See Ghosts (2018)", 
  "Ye (2018)", 
  "Singles", "NA"
)

#Visualization: 
Kanye_West %>%
  count(album, word, sort = TRUE) %>%
  group_by(album) %>%
  top_n(10, n) %>%
  ungroup() %>%
  mutate(album = factor(album, levels = album_order),  
         word = reorder_within(word, n, album)) %>%
  ggplot(aes(n, word, fill = album)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ album, scales = "free_y", ncol = 5) +
  scale_y_reordered() +
  labs(title = "Most frequent words per album",
       x = "Frequency",
       y = NULL) +
  theme_minimal() +
  theme(strip.text = element_text(size = 8)) 


```

As can be seen in the graph, there are words that appear across several
albums by Kanye West, such as "girl," "love," or "fuck."

Finally, the proportion of each word per album will be calculated, and
then the correlation between albums will be analyzed. In this case, two
albums will be selected:

```{r}
# First, the proportion:
frequency <- Kanye_West %>%
  count(album, word) %>%
  group_by(album) %>%
  mutate(proportion = n / sum(n)) %>%
  ungroup() %>%
  pivot_wider(names_from = album, values_from = proportion, values_fill = 0)

# Now the correlations:
cor.test(data = frequency, ~ `Graduation (2007)` + `My Beautiful Dark Twisted Fantasy (2010)`)

cor.test(data = frequency, ~ `Yeezus (2013)` + `Ye (2018)`)
```

n the first analysis, the correlation between Graduation (2007) and My
Beautiful Dark Twisted Fantasy (2010) is very weak and negative
(-0.0448), with a significant p-value (0.0004), suggesting a non-zero
correlation.

In the second analysis, the correlation between Yeezus (2013) and Ye
(2018) is nearly zero (-0.0022), with a high p-value (0.862), indicating
no significant correlation.

# Sentiment Analysis

The goal of this analysis is to understand the emotions and tone of
Kanye West's lyrics throughout his discography. To achieve this, we will
apply three complementary sentiment analysis approaches:

1.NRC: This allows us to identify specific emotions (joy, sadness,
anger, fear, etc.) in his songs, providing a more nuanced view of the
feelings expressed in his lyrics. This is especially useful for an
artist like Kanye, whose content is highly emotional and varied.

2.Bing: To classify words as positive and negative, giving us an overall
sense of the tone of each album or song.

3.AFINN: To apply a numerical scale to the sentiment of words, allowing
us to quantify the overall tone of each song and observe changes in
emotional intensity over time.

To carry out the sentiment analysis, we first need to load the lexicons
and apply them to our data:

```{r}
# Load the lexicons
nrc_lexicon <- get_sentiments("nrc")
bing_lexicon <- get_sentiments("bing")
afinn_lexicon <- get_sentiments("afinn")

# Merge the dataframe with the lexicons
Kanye_sentiment_NRC <- Kanye_West %>%
  inner_join(nrc_lexicon, by = "word")

Kanye_sentiment_Bing <- Kanye_West %>%
  inner_join(bing_lexicon, by = "word")

Kanye_sentiment_AFINN <- Kanye_West %>%
  inner_join(afinn_lexicon, by = "word")

```

### 1. Visualización de emociones con NRC

```{r}
Kanye_sentiment_NRC %>%
  count(sentiment, sort = TRUE) %>%
  ggplot(aes(x = reorder(sentiment, n), y = n, fill = sentiment)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Distribution of emotions in Kanye's lyrics",
       x = "Emotion",
       y = "Frequency") +
  theme_minimal()

# Crear tabla con el conteo de emociones
emotion_table <- Kanye_sentiment_NRC %>%
  count(sentiment, sort = TRUE)

# Ver la tabla
emotion_table
```

The lyrics reflect a wide range of emotions, with a predominance of
positive and negative feelings, which are common in most of his songs.
Emotions such as trust, joy, and anger also appear frequently,
suggesting that the artist expresses a broad spectrum of feelings in his
music, from euphoria to frustration and reflection.

For a deeper analysis, the following graph shows the 4 most frequent
emotions in the lyrics by album:

```{r}
Kanye_sentiment_NRC %>%
  group_by(album, sentiment) %>% 
  count() %>%  
  group_by(album) %>% 
  slice_max(n, n = 4) %>%  
  mutate(album = factor(album, levels = album_order)) %>%  
  ggplot(aes(x = reorder(sentiment, n), y = n, fill = sentiment)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  facet_wrap(~ album, scales = "free_y") + 
  labs(title = "4 most frequent emotions per album",
       x = "Emotion",
       y = "Frequency") +
  theme_minimal()

```

In this analysis, the most frequent emotions per album of Kanye West are
observed. Throughout his career, predominant sentiments include both
positive and negative feelings, reflecting the emotional complexity in
his lyrics. Additionally, sentiments such as joy, anger, and trust
regularly stand out in several albums, suggesting that Kanye explores a
wide range of emotional states, from euphoria to frustration and
distrust.

For example, in the album 808s & Heartbreak (2008), the sentiments
negative and positive are the most prominent, while in Graduation
(2007), there is a strong presence of both positive and negative
sentiments along with anger and trust. In contrast, in Kids See Ghosts
(2018), sentiments are less frequent, but positive and negative
sentiments still stand out.

### 2. Classification with BING:

What will be done is a binary classification between words considered
positive and negative.

```{r}
Kanye_sentiment_Bing %>%
  count(sentiment) %>%
  ggplot(aes(x = sentiment, y = n, fill = sentiment)) +
  geom_col(show.legend = FALSE) +
  labs(title = "Count of Positive and Negative Words",
       x = "Sentiment",
       y = "Frequency") +
  theme_minimal()
```

With Bing's binary classification, it is clear that there is a
predominance of words considered negative. As observed earlier, some of
the most frequent words were "fuck" and "nigga," so this result appears
to be consistent with the previous findings.

Now, let's examine how this classification looks by album:

```{r}
Kanye_sentiment_Bing %>%
  count(album, sentiment) %>%  
  mutate(album = factor(album, levels = album_order)) %>%  
  ggplot(aes(x = sentiment, y = n, fill = sentiment)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ album, scales = "free_y") +  
  labs(title = "Number of Positive and Negative Words by Album",
       x = "Sentiment",
       y = "Frequency") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))   


```

Similar to the previous chart, in all albums except for one (Kids See
Ghosts from 2018), there are more words classified as negative than
positive. However, the gap appears to be larger in more recent albums
(except for the aforementioned one), suggesting a trend towards the use
of negative words.

### 3. Evolution of sentiement with AFINN:

In this part, we will analyze the evolution of sentiment using the AFINN
lexicon scores (from -3 to 3):

```{r}
Kanye_sentiment_AFINN %>%
  group_by(album) %>%
  summarise(sentiment_score = sum(value)) %>%
  mutate(album = factor(album, levels = album_order)) %>%  
  ggplot(aes(x = album, y = sentiment_score, fill = sentiment_score)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Sentiment Evolution in Kanye's Albums",
       x = "Album",
       y = "Sentiment Score") +
  theme_minimal()

```

In general, it stands out that the vast majority of albums have a
negative score, which seems to confirm what we saw earlier—the large
presence of negative words in the songs, and specifically, words with a
high negative score.

On the other hand, we see that there is a positive total score in only
three cases:

808 & Heartbreak (2008), which has the highest score. This is curious
because in this case, the frequency of negative words was greater than
the positive ones, so it seems that the positive words present have a
high score, or the classification was different. Kids See Ghosts (2018)
and the Single also have a positive score, although the result is
tighter.

What's been done earlier is in absolute terms, which can distort the
reality since some albums contain more songs than others. Therefore, we
will also perform a relative analysis using the average instead of the
sum of scores:

```{r}
Kanye_sentiment_AFINN %>%
  group_by(album) %>%
  summarise(sentiment_score_avg = mean(value)) %>% 
  mutate(album = factor(album, levels = album_order)) %>% 
  ggplot(aes(x = album, y = sentiment_score_avg, fill = sentiment_score_avg)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Evolution of Sentiment in Kanye's Albums",
       x = "Album",
       y = "Average Sentiment Score") +
  theme_minimal()

```

Now, the same trend is observed: the majority of albums have a negative
average score, with the three previously mentioned albums still
maintaining a positive score. However, since these are average scores,
some changes are noticeable. The Single now has the highest positive
average score, and Yeezus (2013) is the album with the lowest average
score.

The sentiment analysis of Kanye West's lyrics reveals a complex
emotional landscape throughout his discography. Across his albums, there
is a clear predominance of both positive and negative feelings,
reflecting the emotional depth and diversity in Kanye's music. Emotions
such as joy, anger, and trust appear regularly, suggesting a broad
spectrum of emotional exploration, ranging from euphoria to frustration
and introspection.

The analysis also highlights a consistent presence of negative
sentiment, particularly in more recent albums. Despite the strong
negative presence, certain albums like 808s & Heartbreak (2008) and Kids
See Ghosts (2018) show a mix of both positive and negative emotions,
with a tendency towards more positive sentiment in some cases. The
evolution of sentiment over time demonstrates the emotional shifts in
Kanye’s music, with some albums leaning more heavily on negative tones,
while others explore a balance of emotions.

It’s also worth mentioning that the style of music Kanye West creates
often involves the use of slang, colloquial expressions, and insults,
which further adds to the emotional intensity of his lyrics.

#### INSULT ANALISIS???

To analyze this, we will use the **Luis von Ahn List (LDNOOBW)**, which
is one of the most comprehensive and maintained databases of offensive
words in English. It also includes insults and slangs commonly used in
hip-hop. Additionally, this list is publicly available on GitHub, making
it easily accessible.

What we will do is first examine the relative frequency of insults by
album to enable comparison across Kanye's discography. Then, we will
conduct an AFINN sentiment analysis to determine whether albums with a
higher proportion of insults tend to have more negative sentiment
scores.

```{r}
# First, we obtain the list of insults from GitHub:
url <- "https://raw.githubusercontent.com/LDNOOBW/List-of-Dirty-Naughty-Obscene-and-Otherwise-Bad-Words/master/en"
bad_words_vonahn <- readLines(url)

#Then, we calculate the total number of words per album
total_words_by_album <- Kanye_West %>%
  group_by(album) %>%
  summarise(total_words = n())

Kanye_offensive <- Kanye_West %>%
  filter(word %in% bad_words_vonahn)


# Also we need to calculate the insults per album
insults_by_album <- Kanye_offensive %>%
  group_by(album) %>%
  summarise(insult_count = n())

# Finally, we can merge the total word count and insults count:
relative_insults_by_album <- insults_by_album %>%
  inner_join(total_words_by_album, by = "album") %>%
  mutate(relative_insult_freq = insult_count / total_words)  # Calculate relative frequency


# then, the visualization:
ggplot(relative_insults_by_album, aes(x = reorder(album, relative_insult_freq), y = relative_insult_freq, fill = relative_insult_freq)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Relative Frequency of Insults by Album",
       x = "Album",
       y = "Relative Frequency of Insults") +
  theme_minimal()
```

As can be seen, the albums *Yeezus* (2013) and *My Beautiful Dark
Twisted Fantasy* (2010), which had the lowest sentiment scores in the
previous AFINN analysis, also stand out in terms of the highest
frequency of insults. Similarly, the albums with positive sentiment
scores appear to be the ones with the least number of insults.

For a deeper analysis, we will cross the number of insults with the
AFINN sentiment score to see if albums with more insults tend to have
more negative sentiment.

```{r}
# Firs, we get the average sentiment scores per album using AFINN 
sentiment_by_album <- Kanye_sentiment_AFINN %>%
  group_by(album) %>%
  summarise(sentiment_score_avg = mean(value))  # Average sentiment score

# Then we merge the relative insult frequency with average sentiment scores
insults_sentiment <- relative_insults_by_album %>%
  inner_join(sentiment_by_album, by = "album")

# Relationship between relative insult frequency and average sentiment score
ggplot(insults_sentiment, aes(x = relative_insult_freq, y = sentiment_score_avg, label = album)) +
  geom_point(color = "red", size = 3) +  # albums
  geom_smooth(method = "lm", se = FALSE, color = "blue") +  # line
  geom_text(vjust = -0.5, size = 4) +  # Album labels
  labs(title = "Relationship Between Relative Insult Frequency and Average Sentiments",
       x = "Relative Frequency of Insults",
       y = "Average AFINN Sentiment Score") +
  theme_minimal()

# Finally, the correlation to confirm the relationship
correlation_result <- cor(insults_sentiment$relative_insult_freq, insults_sentiment$sentiment_score_avg)
correlation_result
```

This graph and the correlation confirm this trend, meaning that albums with a higher number of insults generally have lower or more negative sentiment scores. As mentioned, the two albums Yeezus (2013) and My Beautiful Dark Twisted Fantasy (2010) have a higher frequency of insults and, at the same time, lower average AFINN sentiment scores. On the other hand, 808s & Heartbreak (2008), for example, has a positive AFINN score and a low presence of insults.

Finally, we are going to visualize the most common insults or bad words in Kanye’s lyrics in a wordclou:

```{r}
# Count the frequency of bad words 
insult_word_counts <- Kanye_offensive %>%
  count(word, sort = TRUE)

# Create a word cloud for the most common bad words
wordcloud(words = insult_word_counts$word, 
          freq = insult_word_counts$n, 
          min.freq = 1, 
          max.words = 100, 
          scale = c(4, 2.5), 
          colors = brewer.pal(8, "Dark2"))

```

The most common insults in Kanye West's lyrics include "shit," "nigga,"
"fuck," "ass," "bitch," "motherfucker," and "dick." The frequent use of
these words highlights the tendency to employ aggressive language as a
means of expressing raw, powerful emotion.



NO SE SI SERÍA MEJOR LEMATIZE PRIMERO?porque hay algunas como bitch y bicthes

# Term Frequency - TF-IDF

In this section, we have several objectives: 1. To detect unique or "rare" words. 2. To analyze the representativeness of offensive words.

To achieve this, we first need to calculate the TF-IDF:
```{r}
# First, we calculate the TF-IDF
tfidf_data <- Kanye_West %>%
  count(album, word, sort = TRUE) %>%
  bind_tf_idf(word, album, n) %>%
  arrange(desc(tf_idf))

# We want to visualize the 10 most representative words per album
top_tfidf <- tfidf_data %>%
  group_by(album) %>%
  top_n(10, tf_idf) %>%
  ungroup() 

ggplot(top_tfidf, aes(x = reorder(word, tf_idf), y = tf_idf, fill = album)) +
  geom_col(show.legend = FALSE) +  
  coord_flip() +
  facet_wrap(~ album, scales = "free_y") +
  labs(title = "Top Words by TF-IDF for Each Album",
       x = "Word",
       y = "TF-IDF Score") +
  theme_minimal()

```

The TF-IDF analysis seems to reveal that the lyrics are diverse. For example, words like “lift” in Singles and “ghosts” in Kids See Ghosts have relatively high TF-IDF scores, suggesting that these terms are not only frequently used in the respective albums but are also significant in distinguishing these albums from others.

Albums like 808s & Heartbreak, which features words like "amazing" and "heartless", while Yeezus (2013), with words like "aahh", "300", and "bound". This means a switcht in the tone, some albums are more deeper and other seems to be more raw. Also, the analysis reveals the use of both intense emotional words and colloquial expressions that align with the overall tone and message of the albums



Calculate TF-IDF for offensive words:
```{r}
# Filter offensive words 
Kanye_offensive <- Kanye_West %>%
  filter(word %in% bad_words_vonahn)  # List of offensive words previously loaded (Luis von Ahn)

# Calculate TF-IDF for offensive words:
tfidf_offensive <- Kanye_offensive %>%
  count(album, word, sort = TRUE) %>%
  bind_tf_idf(word, album, n) %>%
  arrange(desc(tf_idf))

# 3. Visualize the most important offensive words by TF-IDF for each album:
top_offensive_tfidf <- tfidf_offensive %>%
  group_by(album) %>%
  top_n(10, tf_idf) %>%
  ungroup()

ggplot(top_offensive_tfidf, aes(x = reorder(word, tf_idf), y = tf_idf, fill = album)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  facet_wrap(~ album, scales = "free_y") +
  labs(title = "Top Offensive Words by TF-IDF for each Album",
       x = "Word",
       y = "TF-IDF Score") +
  theme_minimal()

```

Before interpreting the results, it is important to mention that there are albums where swear words are not as common, so their list of words is smaller.

The album "Kids See Ghosts" (2018) features the word "sucks" with the highest TF-IDF, indicating that it is a particularly representative word for this album in relation to its frequency compared to others. The album "My Beautiful Dark Twisted Fantasy" (2010) includes several words with significant TF-IDF values such as "fucking", "pussy", and "motherfucker."

Finally, the album "Yeezus" (2013) also shows a notable frequency of terms like "coon", "fuck", and "bitches", although not as prominently as in other albums. Some rarer words, such as "coon" in "Yeezus" (2013), "threesome" in "Ye" (2018), and "porn" in "My Beautiful Dark Twisted Fantasy" (2010), also appear.

On the other hand, terms like "nigga", "fuck", "bitch", and "ass" appear across multiple albums, but with variations in their TF-IDF. This suggests that, although they are common in Kanye's discography, their weight and prominence vary between different albums.




 
 

# Third technique
